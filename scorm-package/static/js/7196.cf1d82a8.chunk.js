"use strict";(self.webpackChunk_genially_view_client=self.webpackChunk_genially_view_client||[]).push([[7196],{43190:(e,t,i)=>{i.d(t,{q:()=>a});var n=i(45992),l=i(17588),s=i(66264),d=i(60708),o=i(34895),r=i(25e3);const a=e=>{let{getItems:t,item:i,menuType:a,theme:m,shouldCloseWhenClickOutside:u=!1,itemSize:c,menuTheme:h}=e;const[v,g]=(0,l.useState)(t()),[f,p]=(0,l.useState)(!1),S=(0,l.useCallback)((()=>{p((e=>!e))}),[]);null===i||void 0===i||i.on(s.q.Message,(e=>{e===d.m.Entering&&(g(t()),p(!1))}));const T=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i=(0,l.useRef)(null);return(0,l.useEffect)((()=>{const n=t=>{i.current&&!i.current.contains(t.target)&&e(t)};return document.addEventListener("mouseup",n,t),document.addEventListener("touchend",n,t),()=>{document.removeEventListener("mouseup",n,t),document.removeEventListener("touchend",n,t)}}),[i,e,t]),i}((0,l.useCallback)((()=>{u&&f&&p(!1)}),[f,u]),!0);(0,l.useEffect)((()=>{g(t())}),[t]);const y=(0,o.CO)(a);return(0,r.T)({theme:m,children:(0,n.jsx)(y,{items:v,onToggleClick:S,opened:f,ref:T,theme:m,itemSize:c,menuTheme:h})})}},27196:(e,t,i)=>{i.r(t),i.d(t,{geniallyMenuEditorScript:()=>D});var n=i(45992),l=i(17588),s=i(57277),d=i(42511);var o=i(43190),r=i(49443),a=i(34895),m=i(9380),u=i(15536),c=i(99678),h=i(45994),v=i(25e3);const g=(e,t,i,l)=>{const{width:s}=((e,t,i)=>{const l=(0,h.d)((0,v.T)({theme:t,children:(0,n.jsx)(d.W,{children:(0,n.jsx)(c.I,{items:e,menuTheme:i})})}));return{width:l.width+2*u.I,height:l.height+2*u.I}})(t,i,l);return{itemsAreOverflowing:s>e,minimalWidth:s}};var f,p=i(47556);!function(e){e[e.MD=380]="MD"}(f||(f={}));const S=e=>e<=f.MD?m.L.Hamburger:m.L.Horizontal;var T=i(933);const y=new class{constructor(){this.state={}}getState(e){return this.state[e]}setState(e,t){this.state[e]=Object.assign(Object.assign({},this.state[e]),t)}removeState(e){delete this.state[e]}initializeState(e,t){this.state[e]=t}},w=e=>{var t,i;e.item&&e.item.exists&&y.setState(e.item.id,{menuType:e.getConfig().menuType,size:{width:null===(t=e.item)||void 0===t?void 0:t.width,height:null===(i=e.item)||void 0===i?void 0:i.height}})},C=(e,t)=>{let{item:i,editor:n,script:l}=e;if(!i)return;const s=y.getState(i.id);if(!s)return;const d=S(i.width),o=S(s.size.width),u=d!==o,c=i.width!==s.size.width,h=()=>g(i.width,(0,T.N)(l.getConfig().menuItems,n.t),n.theme,t),v=e=>{((e,t,i,n)=>{e!==t.getConfig().menuType&&t.mutateConfig((t=>{t.menuType=e}));const l=(0,a.FB)(e);i.thumbnail!==l.dark&&i.thumbnail!==l.light&&(i.thumbnail=n===r.N.Dark?l.dark:l.light)})(e,l,i,t)};if(u){const{itemsAreOverflowing:e}=h();v(e?m.L.Hamburger:m.L.Horizontal)}else c&&(()=>{const{itemsAreOverflowing:e}=h();v(e?m.L.Hamburger:d)})();w(l)},I=(e,t)=>{var i;if(!e.item||!e.item.exists)return;const{item:n,getConfig:l}=e,s=n,{menuType:d,menuTheme:o}=l(),r=y.getState(e.item.id);if((e=>{let{currentWidth:t,previousWidth:i,currentMenuType:n,previousMenuType:l}=e;return t===i&&n!==l})({currentWidth:s.width,previousWidth:null===r||void 0===r?void 0:r.size.width,currentMenuType:d,previousMenuType:null===r||void 0===r?void 0:r.menuType})){if(d===m.L.Horizontal){const{minimalWidth:l}=g(n.width,(0,T.N)(e.getConfig().menuItems,t.t),t.theme,o),r=(e=>{switch(e){case m.L.Horizontal:return{minWidth:f.MD,maxWidth:void 0};case m.L.Hamburger:return{minWidth:p.N_.width,maxWidth:f.MD};default:return{minWidth:void 0,maxWidth:void 0}}})(d),a=s.parentSlide.size.width-24,u=Math.min(l,a),c=Math.max(null!==(i=r.minWidth)&&void 0!==i?i:0,u);s.setSize(c,p.cE.height),s.setPosition((s.parentSlide.size.width-c)/2,s.y)}d===m.L.Hamburger&&s.setSize(p.N_.width,p.N_.height)}y.setState(e.item.id,{menuType:d,size:{width:null===s||void 0===s?void 0:s.width,height:null===s||void 0===s?void 0:s.height}})};var b=i(17901);const x=(e=>{const t=(e=>t=>{const{editor:i,isSelectableItem:s,selectableItems:o}=t,{selectedItem:r,selectedIndex:a,enableSelection:m,canSelectItem:u}=(0,d.C)();return(0,l.useEffect)((()=>{var e;if(!u)return void(null===(e=i.setToolbarOptions)||void 0===e||e.call(i,[]));if(!r||!s(r))return;const t=o.get(r);t&&t.events.forEach((e=>{var t;null===(t=i.setToolbarOptions)||void 0===t||t.call(i,[{type:e.type}])}))}),[i,r,a,u,s,o]),(0,l.useEffect)((()=>{const e=i.on("itemIsBeingEdited",(e=>{let{isBeingEdited:t}=e;m(t)})),t=i.on("toolbarOptionsChange",(()=>{}));return()=>{null===e||void 0===e||e(),null===t||void 0===t||t()}}),[i,m]),(0,n.jsx)(e,Object.assign({},t))})(e);return e=>(0,n.jsx)(d.W,{isInEditor:!0,children:(0,n.jsx)(t,Object.assign({},e))})})((e=>{let{editor:t,script:i}=e;var s,d;const{theme:r,t:a}=t,{menuItems:m,menuType:u,menuTheme:c}=i.getConfig(),{item:h}=i,v=(e=>e?{width:e.width}:{})(h);(0,l.useEffect)((()=>{C({item:h,editor:t,script:i},c)}),[t,h,c,v,i]);const g={width:null!==(s=null===h||void 0===h?void 0:h.width)&&void 0!==s?s:0,height:null!==(d=null===h||void 0===h?void 0:h.height)&&void 0!==d?d:0};return(0,n.jsx)(o.q,{getItems:()=>(0,T.N)(m,a),menuType:u,theme:r,itemSize:g,menuTheme:c})})),D=e=>{let{script:t,editor:i}=e;i.on("slideCreated",(e=>{let{slide:i}=e;((e,t)=>{!1===e.getConfig().slidesToDisplay.allSlidesSelected&&e.item.excludedSlidesIds.push(t.id)})(t,i)})),i.on("slideDeleted",(e=>{let{slide:n}=e;((e,t)=>{1===e.getSlides().length&&t.mutateConfig((e=>{e.slidesToDisplay.allSlidesSelected=!0,e.slidesToDisplay.selectedSlides=[]}))})(i,t),((e,t)=>{const{allSlidesSelected:i,selectedSlides:n}=e.getConfig().slidesToDisplay;if(!i)if(null===n||void 0===n?void 0:n.includes(t.id))e.mutateConfig((e=>{e.slidesToDisplay.selectedSlides=e.slidesToDisplay.selectedSlides.filter((e=>e!==t.id))}));else{const i=e.item;i.excludedSlidesIds=i.excludedSlidesIds.filter((e=>e!==t.id))}})(t,n)})),t.once("configChange",(()=>{w(t),(e=>{let{editor:t,script:i}=e;0===i.getConfig().slidesToDisplay.selectedSlides.length&&i.mutateConfig((e=>{e.slidesToDisplay.selectedSlides=t.getSlides().map((e=>e.id))}))})({editor:i,script:t})})),t.on("configChange",(e=>{let{config:n,prevConfig:l}=e;((e,t,i,n)=>{e.item&&e.item.exists&&(function(e){const{item:t}=e,i=t;i.isTransversal||(i.isTransversal=!0)}(e),function(e,t,i){const n=i.slidesToDisplay.selectedSlides.filter((e=>t.getSlides().find((t=>t.id===e))));n.length!==i.slidesToDisplay.selectedSlides.length&&e.mutateConfig((e=>{e.slidesToDisplay.selectedSlides=n}))}(e,t,i),function(e,t,i,n){const{item:l}=e,s=l;(i.slidesToDisplay.allSlidesSelected!==(null===n||void 0===n?void 0:n.slidesToDisplay.allSlidesSelected)||i.slidesToDisplay.selectedSlides!==(null===n||void 0===n?void 0:n.slidesToDisplay.selectedSlides))&&(s.excludedSlidesIds=function(e,t){if(e.slidesToDisplay.allSlidesSelected)return[];const i=t.getSlides(),n=e.slidesToDisplay.selectedSlides||[];return i.filter((e=>!n.includes(e.id))).map((e=>e.id))}(i,t),e.mutateConfig((e=>{e.slidesToDisplay.allSlidesSelected&&(e.slidesToDisplay.selectedSlides=[])})))}(e,t,i,n))})(t,i,n,l),(e=>{if(!e.item||!e.item.exists)return;const{item:t,getConfig:i}=e,n=t,{menuType:l,menuTheme:s}=i(),d=y.getState(e.item.id),o=(0,a.FB)(l);(null===d||void 0===d?void 0:d.menuType)===l&&(null===d||void 0===d?void 0:d.menuTheme)===s||(n.thumbnail=s===r.N.Dark?o.dark:o.light)})(t),I(t,i);const{item:s}=t;s&&"showOverflow"in s&&!s.showOverflow&&(s.showOverflow=!0)})),t.on("dispose",(()=>{var e,i,n;(null===(e=null===t||void 0===t?void 0:t.item)||void 0===e?void 0:e.id)&&(null===(n=null===(i=y.getState(t.item.id))||void 0===i?void 0:i.disposer)||void 0===n||n.call(i),y.removeState(t.item.id))})),(0,s.x)({getTargetNodeItem:()=>t.item,renderApp:()=>(0,n.jsx)(x,{editor:i,script:t,isSelectableItem:b.M2,selectableItems:b.Xg}),nodePrefix:"menu"})({script:t,editor:i})}},933:(e,t,i)=>{i.d(t,{N:()=>s,e:()=>o});var n=i(48237);const l=(e,t)=>""===e?t("__new.view.widget.menu.sidebar.emptyTitlePlaceholder"):e,s=(e,t)=>e.map(((e,i)=>{var s;const d=(null===(s=e.menuItemAction.action)||void 0===s?void 0:s.type)===n.L.GoToSlide;return{text:l(e.menuItemName,t),key:i,onClick:()=>{},isLink:d,isActive:!1,isAllowed:d,altText:e.altText}})),d={active:!1,allowed:!1},o=(e,t)=>e.map(((e,i)=>{var s,o;const r=!!(null===(s=e.menuItemAction)||void 0===s?void 0:s.data)&&(null===(a=e.menuItemAction.data)||void 0===a?void 0:a.type)===n.L.GoToSlide;var a;const{active:m,allowed:u}=r&&(null===(o=e.menuItemAction)||void 0===o?void 0:o.data)?t.getGoToSlideState(e.menuItemAction.data):d;return{text:l(e.menuItemName,t.t),key:i,onClick:()=>{var t;return null===(t=e.menuItemAction)||void 0===t?void 0:t.run()},isLink:r,isActive:m,isAllowed:u,altText:e.altText}}))},57277:(e,t,i)=>{i.d(t,{x:()=>l});var n=i(70377);function l(e){let{getTargetNodeItem:t,renderApp:i,renderThumbnailApp:l,nodePrefix:s}=e;return e=>{let{script:d,editor:o}=e,r=null,a=[];function m(e){r&&(n.unmountComponentAtNode(r),r=null),e&&"innerHtml"in e&&(e.innerHtml='<div class="card-iframe"><div style="width: 100%; height: 100%; background: #FF0000; color: #FFFFFF;">Deleted</div><script><\/script></div>')}function u(){r&&n.render(i(),r)}function c(){const e=t(d.getConfig());if(!e)return;const i=`${s}-${e.id}`;"innerHtml"in e&&(e.innerHtml=`<div class="card-iframe"><div id="${i}" class="genially-widget-app" style="width: 100%; height: 100%;"></div></div>`),requestAnimationFrame((()=>{r="idOfFreeNode"in e?document.getElementById(e.idOfFreeNode)||null:document.getElementById(i)||null,u()}))}function h(){l&&a.length&&a.forEach((e=>{n.render(l(),e)}))}function v(){const e=t(d.getConfig());e&&"idOfThumbnailFreeNode"in e&&requestAnimationFrame((()=>{const t=document.getElementsByClassName(e.idOfThumbnailFreeNode);a=Array.from(t),h()}))}d.on("configChange",(e=>{let{config:i,prevConfig:n}=e;const l=t(i),s=n?t(n):void 0;s&&s!==l&&m(s),l&&(l!==s?(c(),v()):(u(),h()))})),d.on("dispose",(()=>{m(t(d.getConfig()))})),o.on("itemMount",(e=>{let{item:t}=e;t===d.item&&c()})),o.on("itemUnmount",(e=>{let{item:t}=e;t===d.item&&m()})),o.on("itemThumbnailMount",(e=>{let{item:t}=e;t===d.item&&v()}))}}}}]);
//# sourceMappingURL=https://s3-static-genially.genially.com/view/static/js/7196.cf1d82a8.chunk.js.map